function fitim=hexagonalspots(X,Y,p)

amp=p(1);
rad=p(2);
ang=p(3);
sig=p(4);

xy1=[rad 0.]*rotmat(ang);
xy2=[rad 0.]*rotmat(ang+pi/3.);
xy3=[rad 0.]*rotmat(ang+2*pi/3.);

fitim = amp.*(...
    exp(-((X-xy1(1)).^2+(Y-xy1(2)).^2)/sig^2)+...
    exp(-((X-xy2(1)).^2+(Y-xy2(2)).^2)/sig^2)+...
    exp(-((X-xy3(1)).^2+(Y-xy3(2)).^2)/sig^2)+...
    exp(-((X+xy1(1)).^2+(Y+xy1(2)).^2)/sig^2)+...
    exp(-((X+xy2(1)).^2+(Y+xy2(2)).^2)/sig^2)+...
    exp(-((X+xy3(1)).^2+(Y+xy3(2)).^2)/sig^2) );